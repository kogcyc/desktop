<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    html {
      background: #000;
      color: #fff;
      font-family: sans-serif;
      font-size: 0.8em;
    }

    .timedate {
      background-color: #fff;
      color: #000;
      padding: 1px 6px;
      font-family: monospace;
      font-size: 1.4em;
      font-weight: 900;
      letter-spacing: 2px;
      border-radius: 4px;
      margin-right: 20px;
      border: none;
      outline: none;
      display: inline-block;
    }

    a {
      color: #fff;
    }

    .aa {
      background: #456;
      color: #fff;
      font-size: 1.5em;
      letter-spacing: 2px;
      font-weight: 900;
      text-align: center;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      height: 128px;
      width: 12em;
    }

    img {
      height: 24px;
      margin: 4px;
    }
  </style>
</head>

<body>

  <div id="topbar">
    <svg id="clock" xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <circle cx="50" cy="50" r="45" fill="#222" />
      <line id="hourHand" x1="50" y1="50" x2="50" y2="24" stroke="#222" stroke-width="4" />
      <line id="minuteHand" x1="50" y1="50" x2="50" y2="14" stroke="#222" stroke-width="4" />
      <line id="secondHand" x1="50" y1="55" x2="50" y2="10" stroke="#222" stroke-width="2" />
    </svg>

    <!-- Some service links -->
    <a href="https://mail.google.com/"><img src="./svg/gmail.svg" alt="Gmail"></a>
    <a href="https://www.amazon.com/"><img src="./svg/amazon.svg" alt="Amazon"></a>
    <a href="https://chat.openai.com/"><img src="./svg/chatgpt.svg" alt="ChatGPT"></a>
    <a href="https://github.com"><img src="./svg/github.svg" alt="GitHub"></a>
  </div>

  <br><br>

  <!-- Time Displays -->
  <span class="timedate" id="berkeley"></span>
  <span class="timedate" id="paris"></span>
  <span class="timedate" id="tokyoTimeWeather">Loading Tokyo weather...</span>
  <br><br>

  <!-- Optional Date Picker -->
  <input type="date" class="timedate"><br><br>

  <!-- Clock logic -->
  <script>
    function isDST() {
      const today = new Date();
      const jan = new Date(today.getFullYear(), 0, 1);
      const jul = new Date(today.getFullYear(), 6, 1);
      return today.getTimezoneOffset() < Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());
    }

    function displayTime(id, offset) {
      const now = new Date();
      const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
      const time = new Date(utc + (3600000 * offset));
      const hour = time.getUTCHours().toString().padStart(2, '0');
      const minute = time.getUTCMinutes().toString().padStart(2, '0');
      document.getElementById(id).innerText = `${id.charAt(0).toUpperCase() + id.slice(1)}: ${hour}:${minute}`;
    }

    const berkeleyOffset = isDST() ? -7 : -8;
    const parisOffset = isDST() ? 2 : 1;

    displayTime("berkeley", berkeleyOffset);
    displayTime("paris", parisOffset);
  </script>

  <!-- SVG Clock Update -->
  <script>
    function updateClock() {
      const now = new Date();
      const seconds = now.getSeconds();
      const minutes = now.getMinutes();
      const hours = now.getHours();

      const secondsAngle = (seconds / 60) * 360;
      const minutesAngle = ((minutes * 60 + seconds) / 3600) * 360;
      const hoursAngle = ((hours * 3600 + minutes * 60 + seconds) / 43200) * 360;

      document.getElementById('secondHand').setAttribute('transform', `rotate(${secondsAngle} 50 50)`);
      document.getElementById('minuteHand').setAttribute('transform', `rotate(${minutesAngle} 50 50)`);
      document.getElementById('hourHand').setAttribute('transform', `rotate(${hoursAngle} 50 50)`);

      document.getElementById("hourHand").setAttribute("stroke", "#fff");
      document.getElementById("minuteHand").setAttribute("stroke", "#fff");
      document.getElementById("secondHand").setAttribute("stroke", "#f00");
    }

    setInterval(updateClock, 1000);
  </script>

  <!-- Tokyo Weather -->
  <script>
    function updateTokyoTimeWeather() {
      const now = new Date();
      const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
      const tokyoOffset = 9; // UTC+9
      const tokyoTime = new Date(utc + (3600000 * tokyoOffset));
      const hours = tokyoTime.getHours().toString().padStart(2, '0');
      const minutes = tokyoTime.getMinutes().toString().padStart(2, '0');
      const timeString = `${hours}:${minutes}`;

      const apiKey = '04c26f3853be98c54d221b0b4901ffce'; // <-- Replace this!
      const weatherUrl = `https://api.openweathermap.org/data/2.5/weather?q=Tokyo&units=metric&appid=${apiKey}`;

      fetch(weatherUrl)
        .then(response => response.json())
        .then(data => {
          const temp = Math.round(data.main.temp);
          const weather = data.weather[0].main;
          const weatherText = `Tokyo: ${timeString}, ${temp}Â°C, ${weather}`;
          document.getElementById('tokyoTimeWeather').innerText = weatherText;
        })
        .catch(err => {
          console.error("Weather error:", err);
          document.getElementById('tokyoTimeWeather').innerText = `Tokyo: ${timeString}, Weather unavailable`;
        });
    }

    updateTokyoTimeWeather();
    setInterval(updateTokyoTimeWeather, 600000); // every 10 mins
  </script>

  <!-- URL launcher -->
  <input type="text" id="inputField" placeholder="Enter subdomain">
  <button onclick="loadUrl()">Go</button>
  <script>
    function loadUrl() {
      const val = document.getElementById('inputField').value.trim();
      if (val) {
        window.location.href = `https://${val}.up.railway.app`;
      }
    }
  </script>

</body>
</html>
